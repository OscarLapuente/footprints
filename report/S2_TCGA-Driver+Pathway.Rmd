# Associations with known driver mutations

```{r setup2, include=FALSE}
library(magrittr)
b = import('base')
io = import('io')
st = import('stats')
ar = import('array')
df = import('data_frame')
plt = import('plot')
tcga = import('data/tcga')
util = import('./util_2')
```

## Mutations affecting pathway scores for all methods

```{r capture, echo=FALSE, fig.cap='Overall association strength'}
keep = util$assocs_cov %>%
    group_by(m) %>%
    filter(any(-log10(adj.p) > 5)) %>%
    summarize(mlogp = -sum(log10(adj.p))) %>%
    arrange(-mlogp) %$%
    m

util$mutation_overview_plot(util$assocs_cov, keep)
```

## Comparison of methods for individual mutations

```{r detail, echo=FALSE, fig.width=8, fig.height=10, fig.cap='Comparison across methods'}
tt = theme(text = element_text(size=8),
           axis.text.x = element_text(size=7),
           axis.text.y = element_text(size=7),
           axis.title.x = element_text(size=7),
           axis.title.y = element_text(size=7),
           legend.key.width = unit(0.5, "line"))

plots = lapply(keep, function(x) util$mutation_method_plot(x, util$assocs_cov) + ggtitle(x) + tt)
plot_grid(plotlist=plots, ncol=4, label_size=4)
```

## Discussion

... write some thoughts here ...
