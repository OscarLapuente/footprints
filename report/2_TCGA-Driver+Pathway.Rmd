# Comparison of different pathway methods in terms of TCGA mutation recall

```{r setup2, include=FALSE}
library(dplyr)
b = import('base')
io = import('io')
st = import('stats')
ar = import('array')
df = import('data_frame')
plt = import('plot')
tcga = import('data/tcga')

##TODO: %each>% || %>>% operator?

#' Loads a specific TCGA scores file
#'
#' supplies path and extension, and cuts rownames at 16 chars
#'
#' @param x       An identifier, like 'speed_matrix'
#' @param filter  Which subset of the mutation associations to use
#' @return        A matrix with samples as rows and genes and columns
assoc_df = function(x, filter="pan_cov") {
    load_fun = function(x) {
        io$file_path("../analyses/tcga_pathway_per_mutation/assocs_driver_mapped", x, ext=".RData") %>%
            io$load() %>%
            filter(subset == filter) %>%
            mutate(method = x)
    }
    re = bind_rows(lapply(x, load_fun))
}

scores = c('gsea_reactome', 'gsea_go', 'speed_matrix', 'pathifier', 'spia', 'paradigm')

assocs_cov = assoc_df(scores, "pan_cov")
assocs_nocov = assoc_df(scores, "pan")
```

## Overview of number of driver mutations per cancer type

### TP53

```{r tp53, echo=FALSE, fig.width=3.5}
cur = filter(assocs_cov, m == "TP53")
lmax = max(abs(cur$statistic))
p1 = cur %>%
    mutate(label = ifelse(adj.p < 1e-5, "*", "")) %>%
    mutate(label = ifelse(adj.p < 1e-15, "***", label)) %>%
    plt$matrix(statistic ~ scores + method, color="estimate", limits=c(-lmax,lmax))
print(p1)
```

### KRAS

```{r kras, echo=FALSE, fig.width=3.5}
cur = filter(assocs_cov, m == "KRAS")
lmax = max(abs(cur$statistic))
p1 = cur %>%
    mutate(label = ifelse(adj.p < 0.05, "*", "")) %>%
    mutate(label = ifelse(adj.p < 1e-3, "***", label)) %>%
    plt$matrix(statistic ~ scores + method, color="estimate", limits=c(-lmax,lmax))
print(p1)
```

### VHL

```{r vhl, echo=FALSE, fig.width=3.5}
cur = filter(assocs_nocov, m == "VHL")
lmax = max(abs(cur$statistic))
p1 = cur %>%
    mutate(label = ifelse(adj.p < 1e-5, "*", "")) %>%
    mutate(label = ifelse(adj.p < 1e-20, "***", label)) %>%
    plt$matrix(statistic ~ scores + method, color="estimate", limits=c(-lmax,lmax))
print(p1)
```

### STK11

```{r stk11, echo=FALSE, fig.width=3.5}
cur = filter(assocs_cov, m == "STK11")
lmax = max(abs(cur$statistic))
p1 = cur %>%
    mutate(label = ifelse(adj.p < 0.05, "*", "")) %>%
    mutate(label = ifelse(adj.p < 1e-3, "***", label)) %>%
    plt$matrix(statistic ~ scores + method, color="estimate", limits=c(-lmax,lmax))
print(p1)
```
